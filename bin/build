#!/usr/bin/env php
<?php
// Usage: build [--watch|-w] PATH_TO_BUILD_JSON [PATH_TO_DEFAULT_BUILD_JSON]
$autoloadLocations = [
	__DIR__ . "/../../../autoload.php",
	__DIR__ . "/../vendor/autoload.php",
];
foreach($autoloadLocations as $location) {
	if(file_exists($location)) {
		require($location);
		break;
	}
}

$watch = false;
$path = null;
$defaultPath = null;

foreach($argv as $i => $arg) {
	if($i === 0) {
		continue;
	}

	if($arg === "--watch"
	|| $arg === "-w") {
		$watch = true;
	}
	else if(is_null($path)) {
		$path = $arg;
	}
	else if(is_null($defaultPath)) {
		$defaultPath = $arg;
	}
}

if(!is_null($defaultPath)) {
	Gt\Build\BuildRunner::setDefault($defaultPath);
}

Gt\Build\BuildRunner::run($path, $watch);
